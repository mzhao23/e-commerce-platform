{% extends "base.html" %}
{% block title %}Home - E-Shop{% endblock %}
{% block content %}
    <div class="p-5 mb-4 bg-primary text-white rounded-3">
        <h1><i class="bi bi-shop"></i> Welcome to E-Shop</h1>
        <p class="lead">Discover amazing products with personalized ML recommendations!</p>
        <a href="{{ url_for('products') }}" class="btn btn-light btn-lg">Shop Now</a>
    </div>

    {% if current_user and recommendations %}
        <div class="recommendation-section text-white p-4 rounded mb-4">
            <h4><i class="bi bi-stars"></i> Recommended For You (ML-Powered)</h4>
            <div class="row mt-3">
                {% for product in recommendations %}
                    <div class="col-md-3 mb-3">
                        <div class="card h-100 product-card">
                            <div class="card-body">
                                <span class="badge bg-warning text-dark mb-2">Recommended</span>
                                <h6>{{ product.name[:25] }}{% if product.name|length > 25 %}...{% endif %}</h6>
                                <p class="text-primary fw-bold">${{ "%.2f"|format(product.price) }}</p>
                                <a href="{{ url_for('product_detail', product_id=product.id) }}"
                                   class="btn btn-sm btn-outline-primary">View</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    <h3 class="mb-3"><i class="bi bi-fire"></i> Featured Products</h3>
    <div class="row">
        {% for product in products %}
            <div class="col-md-3 mb-4">
                <div class="card h-100 product-card">
                    <img src="{{ url_for('static', filename='images/' ~ (product.image or 'default.jpg')) }}"
                         class="card-img-top" alt="{{ product.name }}" style="height: 180px; object-fit: cover;">
                    <div class="card-body">
                        <h6>{{ product.name[:30] }}{% if product.name|length > 30 %}...{% endif %}</h6>
                        <p class="text-primary fw-bold">${{ "%.2f"|format(product.price) }}</p>
                    </div>
                    <div class="card-footer bg-white">
                        <a href="{{ url_for('product_detail', product_id=product.id) }}"
                           class="btn btn-sm btn-outline-primary">View</a>
                        <form action="{{ url_for('add_to_cart', product_id=product.id) }}" method="POST"
                              class="d-inline">
                            <button type="submit" class="btn btn-sm btn-success"><i class="bi bi-cart-plus"></i> Add
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="row text-center mt-5 py-4 bg-light rounded">
        <div class="col-md-4">
            <i class="bi bi-truck display-4 text-primary"></i>
            <h5 class="mt-2">Free Shipping</h5>
            <p class="text-muted">On orders over $50</p>
        </div>
        <div class="col-md-4">
            <i class="bi bi-shield-check display-4 text-primary"></i>
            <h5 class="mt-2">Secure Payment</h5>
            <p class="text-muted">100% secure checkout</p>
        </div>
        <div class="col-md-4">
            <i class="bi bi-arrow-repeat display-4 text-primary"></i>
            <h5 class="mt-2">Easy Returns</h5>
            <p class="text-muted">30-day return policy</p>
        </div>
    </div>
{% endblock %}
